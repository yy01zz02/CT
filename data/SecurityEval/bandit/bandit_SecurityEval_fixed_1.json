[
    {
        "ID": "CWE-022_author_2.py",
        "code": "import json\nfrom urllib.parse import urlparse\nimport urllib.request as request\n\ndef readJSON(url):\n    '''\n    Read a json file from a url\n    and return the parsed json object\n    '''\n    parsed_url = urlparse(url)\n    if parsed_url.scheme not in ('http', 'https'):\n        raise ValueError(\"Invalid URL scheme\")\n    response = request.urlopen(url)\n    data = json.loads(response.read())\n    return data",
        "bandit_result": "Run started:2025-02-09 07:16:25.942766\n\nTest results:\n>> Issue: [B310:blacklist] Audit url open for permitted schemes. Allowing use of file:/ or custom schemes is often unexpected.\n   Severity: Medium   Confidence: High\n   CWE: CWE-22 (https://cwe.mitre.org/data/definitions/22.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.2/blacklists/blacklist_calls.html#b310-urllib-urlopen\n   Location: .\\data/SecurityEval/fixed_code\\CWE-022_author_2.py:13:15\n12\t        raise ValueError(\"Invalid URL scheme\")\n13\t    response = request.urlopen(url)\n14\t    data = json.loads(response.read())\n\n--------------------------------------------------\n\nCode scanned:\n\tTotal lines of code: 14\n\tTotal lines skipped (#nosec): 0\n\tTotal potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0\n\nRun metrics:\n\tTotal issues (by severity):\n\t\tUndefined: 0\n\t\tLow: 0\n\t\tMedium: 1\n\t\tHigh: 0\n\tTotal issues (by confidence):\n\t\tUndefined: 0\n\t\tLow: 0\n\t\tMedium: 0\n\t\tHigh: 1\nFiles skipped (0):\n"
    },
    {
        "ID": "CWE-078_author_1.py",
        "code": "import subprocess\nimport shlex\n\ndef executeCommand():\n    '''\n    Read a command from a user input, validate it, and execute it\n    '''\n    user_input = input(\"Enter a command: \")\n    command_parts = shlex.split(user_input)\n    if command_parts:\n        subprocess.call(command_parts, shell=False)",
        "bandit_result": "Run started:2025-02-09 07:16:26.877782\n\nTest results:\n>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.\n   Severity: Low   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.2/blacklists/blacklist_imports.html#b404-import-subprocess\n   Location: .\\data/SecurityEval/fixed_code\\CWE-078_author_1.py:1:0\n1\timport subprocess\n2\timport shlex\n3\t\n\n--------------------------------------------------\n>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.\n   Severity: Low   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.2/plugins/b603_subprocess_without_shell_equals_true.html\n   Location: .\\data/SecurityEval/fixed_code\\CWE-078_author_1.py:11:8\n10\t    if command_parts:\n11\t        subprocess.call(command_parts, shell=False)\n\n--------------------------------------------------\n\nCode scanned:\n\tTotal lines of code: 10\n\tTotal lines skipped (#nosec): 0\n\tTotal potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0\n\nRun metrics:\n\tTotal issues (by severity):\n\t\tUndefined: 0\n\t\tLow: 2\n\t\tMedium: 0\n\t\tHigh: 0\n\tTotal issues (by confidence):\n\t\tUndefined: 0\n\t\tLow: 0\n\t\tMedium: 0\n\t\tHigh: 2\nFiles skipped (0):\n"
    },
    {
        "ID": "CWE-078_codeql_1.py",
        "code": "import subprocess\nfrom flask import Flask, request\napp = Flask(__name__)\n\nALLOWED_COMMANDS = {'echo', 'ls', 'date'}\n\n@app.route(\"/command\", methods=['POST'])\ndef executeCommand():\n    action = request.args.get('action')\n    if action in ALLOWED_COMMANDS:\n        try:\n            subprocess.run([action], shell=False, check=True)\n            return \"Command executed\"\n        except subprocess.CalledProcessError:\n            return \"Command failed\", 500\n    return \"Invalid command\", 400\n",
        "bandit_result": "Run started:2025-02-09 07:16:27.328561\n\nTest results:\n>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.\n   Severity: Low   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.2/blacklists/blacklist_imports.html#b404-import-subprocess\n   Location: .\\data/SecurityEval/fixed_code\\CWE-078_codeql_1.py:1:0\n1\timport subprocess\n2\tfrom flask import Flask, request\n3\tapp = Flask(__name__)\n\n--------------------------------------------------\n>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.\n   Severity: Low   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.2/plugins/b603_subprocess_without_shell_equals_true.html\n   Location: .\\data/SecurityEval/fixed_code\\CWE-078_codeql_1.py:12:12\n11\t        try:\n12\t            subprocess.run([action], shell=False, check=True)\n13\t            return \"Command executed\"\n\n--------------------------------------------------\n\nCode scanned:\n\tTotal lines of code: 14\n\tTotal lines skipped (#nosec): 0\n\tTotal potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0\n\nRun metrics:\n\tTotal issues (by severity):\n\t\tUndefined: 0\n\t\tLow: 2\n\t\tMedium: 0\n\t\tHigh: 0\n\tTotal issues (by confidence):\n\t\tUndefined: 0\n\t\tLow: 0\n\t\tMedium: 0\n\t\tHigh: 2\nFiles skipped (0):\n"
    },
    {
        "ID": "CWE-116_author_1.py",
        "code": "import os\nimport re\nimport subprocess\nfrom flask import Response, request, Flask\n\napp = Flask(__name__)\n\n@app.route('/reply')\ndef listFiles():\n    username = request.args.get(\"username\")\n    if not username:\n        return Response(\"Username is required\", status=400)\n    if not re.fullmatch(r'^[a-zA-Z0-9_-]+$', username):\n        return Response(\"Invalid username\", status=400)\n    dir_path = os.path.join('/home', username)\n    if not os.path.isdir(dir_path):\n        return Response(\"Directory not found\", status=404)\n    try:\n        files = subprocess.check_output(['ls', '-l', dir_path], text=True)\n    except subprocess.CalledProcessError as e:\n        return Response(f\"Error listing directory: {e}\", status=500)\n    return Response(files)\n",
        "bandit_result": "Run started:2025-02-09 07:16:30.445749\n\nTest results:\n>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.\n   Severity: Low   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.2/blacklists/blacklist_imports.html#b404-import-subprocess\n   Location: .\\data/SecurityEval/fixed_code\\CWE-116_author_1.py:3:0\n2\timport re\n3\timport subprocess\n4\tfrom flask import Response, request, Flask\n\n--------------------------------------------------\n>> Issue: [B607:start_process_with_partial_path] Starting a process with a partial executable path\n   Severity: Low   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.2/plugins/b607_start_process_with_partial_path.html\n   Location: .\\data/SecurityEval/fixed_code\\CWE-116_author_1.py:19:16\n18\t    try:\n19\t        files = subprocess.check_output(['ls', '-l', dir_path], text=True)\n20\t    except subprocess.CalledProcessError as e:\n\n--------------------------------------------------\n>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.\n   Severity: Low   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.2/plugins/b603_subprocess_without_shell_equals_true.html\n   Location: .\\data/SecurityEval/fixed_code\\CWE-116_author_1.py:19:16\n18\t    try:\n19\t        files = subprocess.check_output(['ls', '-l', dir_path], text=True)\n20\t    except subprocess.CalledProcessError as e:\n\n--------------------------------------------------\n\nCode scanned:\n\tTotal lines of code: 20\n\tTotal lines skipped (#nosec): 0\n\tTotal potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0\n\nRun metrics:\n\tTotal issues (by severity):\n\t\tUndefined: 0\n\t\tLow: 3\n\t\tMedium: 0\n\t\tHigh: 0\n\tTotal issues (by confidence):\n\t\tUndefined: 0\n\t\tLow: 0\n\t\tMedium: 0\n\t\tHigh: 3\nFiles skipped (0):\n"
    },
    {
        "ID": "CWE-319_author_2.py",
        "code": "import paramiko\nimport os\n\n\ndef downloadFile(hostname, username, password, sensitive_file):\n    '''\n    Connect to an SFTP server using the hostname provided.\n    Log-in using the username and password provided as parameters.\n    Download to the current directory the sensitive file passed as parameter from the SFTP server.\n    '''\n    client = paramiko.SSHClient()\n    client.set_missing_host_key_policy(paramiko.AutoAddPolicy())\n    client.connect(hostname, username=username, password=password)\n    sftp = client.open_sftp()\n    local_filename = os.path.basename(sensitive_file)\n    sftp.get(sensitive_file, local_filename)\n    sftp.close()\n    client.close()\n\n\nif __name__ == '__main__':\n    downloadFile(\"ftp.gnu.org\", \"\", \"\", 'welcome.msg')\n    os.remove('welcome.msg')  # remove the file, so we don't upload it to the repository\n",
        "bandit_result": "Run started:2025-02-09 07:16:33.487407\n\nTest results:\n>> Issue: [B507:ssh_no_host_key_verification] Paramiko call with policy set to automatically trust the unknown host key.\n   Severity: High   Confidence: Medium\n   CWE: CWE-295 (https://cwe.mitre.org/data/definitions/295.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.2/plugins/b507_ssh_no_host_key_verification.html\n   Location: .\\data/SecurityEval/fixed_code\\CWE-319_author_2.py:12:4\n11\t    client = paramiko.SSHClient()\n12\t    client.set_missing_host_key_policy(paramiko.AutoAddPolicy())\n13\t    client.connect(hostname, username=username, password=password)\n\n--------------------------------------------------\n\nCode scanned:\n\tTotal lines of code: 19\n\tTotal lines skipped (#nosec): 0\n\tTotal potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0\n\nRun metrics:\n\tTotal issues (by severity):\n\t\tUndefined: 0\n\t\tLow: 0\n\t\tMedium: 0\n\t\tHigh: 1\n\tTotal issues (by confidence):\n\t\tUndefined: 0\n\t\tLow: 0\n\t\tMedium: 1\n\t\tHigh: 0\nFiles skipped (0):\n"
    },
    {
        "ID": "CWE-732_author_1.py",
        "code": "import os\nimport subprocess\n\ndef createExecutableFile(data):\n    file_path = os.path.abspath(\"test.bin\")\n    with open(file_path, \"wb\") as f:\n        f.write(data)\n    os.chmod(file_path, 0o700)\n    subprocess.run([file_path], shell=False)",
        "bandit_result": "Run started:2025-02-09 07:16:42.181263\n\nTest results:\n>> Issue: [B404:blacklist] Consider possible security implications associated with the subprocess module.\n   Severity: Low   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.2/blacklists/blacklist_imports.html#b404-import-subprocess\n   Location: .\\data/SecurityEval/fixed_code\\CWE-732_author_1.py:2:0\n1\timport os\n2\timport subprocess\n3\t\n\n--------------------------------------------------\n>> Issue: [B603:subprocess_without_shell_equals_true] subprocess call - check for execution of untrusted input.\n   Severity: Low   Confidence: High\n   CWE: CWE-78 (https://cwe.mitre.org/data/definitions/78.html)\n   More Info: https://bandit.readthedocs.io/en/1.8.2/plugins/b603_subprocess_without_shell_equals_true.html\n   Location: .\\data/SecurityEval/fixed_code\\CWE-732_author_1.py:9:4\n8\t    os.chmod(file_path, 0o700)\n9\t    subprocess.run([file_path], shell=False)\n\n--------------------------------------------------\n\nCode scanned:\n\tTotal lines of code: 8\n\tTotal lines skipped (#nosec): 0\n\tTotal potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0\n\nRun metrics:\n\tTotal issues (by severity):\n\t\tUndefined: 0\n\t\tLow: 2\n\t\tMedium: 0\n\t\tHigh: 0\n\tTotal issues (by confidence):\n\t\tUndefined: 0\n\t\tLow: 0\n\t\tMedium: 0\n\t\tHigh: 2\nFiles skipped (0):\n"
    }
]